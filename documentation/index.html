<!DOCTYPE html>
<head>
<meta charset="utf-8" />
<title>MATLink — Documentation</title>
<meta name="description" content="">
<meta name="author" content="R. Menon, Sz. Horvát">

<link rel="stylesheet" href="/MATLink/assets/css/bootstrap.css">
<link rel="stylesheet" href="/MATLink/assets/css/site.css">
<link rel="stylesheet" href="/MATLink/assets/css/prettify.css">
<link rel="stylesheet" href="/MATLink/assets/css/lang-matlab.css">
<link rel="stylesheet" href="/MATLink/assets/css/lang-mma.css">
<link rel="stylesheet" href="/MATLink/assets/css/font-awesome.min.css">

</head>
<body>

<!--navigation bar-->
<div class="navbar navbar-inverse navbar-fixed-top">
	<div class="navbar-inner">
		<div class="container">
			<a class="brand" href="/MATLink/">MATLink</a>
			<ul class="nav">
				<li><a href="/MATLink/#installation">Installation</a></li>
				<li class="dropdown">
				<a href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">
					Getting started
					<i class="icon-caret-down"></i>
				</a>
				<ul class="dropdown-menu" role="menu">
					<li class=""><a href="/MATLink/#connecting">Connecting to MATLink</a></li>
					<li class=""><a href="/MATLink/#executing-matlab">Executing MATLAB commands</a></li>
					<li class=""><a href="/MATLink/#transferring-data">Transferring data</a></li>
					<li class=""><a href="/MATLink/#scripts-functions">Working with scripts and functions</a></li>
				</ul>
				</li>
				<li><a href="/MATLink/documentation/">Documentation</a></li>
				<li><a href="/MATLink/examples/">Examples</a></li>
			</ul>
		</div>
	</div>
</div>

<div class="container">
<h1 class="main-header">Documentation</h1>
<p>MATLink is a <i>Mathematica</i><sup>™</sup> application for seamless two-way communication and data transfer with MATLAB<sup>™</sup>. It is written in Mathematica and C++ and connects to MATLAB using the <a href="http://www.mathworks.com/help/matlab/matlab_external/using-matlab-engine.html">MATLAB Engine interface</a>
<h2>Reference</h2>
<section id="connection">
	<h3>Connecting to MATLAB</h3>
	<ul id="install-tabs" class="nav nav-tabs">
		<li class="active"><a href="#connection-introduction" data-toggle="tab">Introduction</a></li>
		<li><a href="#ConnectEngine" data-toggle="tab">ConnectEngine</a></li>
		<li><a href="#DisconnectEngine" data-toggle="tab">DisconnectEngine</a></li>
		<li><a href="#OpenMATLAB" data-toggle="tab">OpenMATLAB</a></li>
		<li><a href="#CloseMATLAB" data-toggle="tab">CloseMATLAB</a></li>
	</ul>

	<div id="install-tabs-content" class="tab-content">
		<div class="tab-pane fade in active" id="connection-introduction">
			<p>MATLink has four functions that handle various aspects of startup and shutdown of MATLAB and the underlying engine</p>
			<ul>
				<li><a href="#ConnectEngine"><code>ConnectEngine</code></a> and <a href="#DisconnectEngine"><code>DisconnectEngine</code></a></li>
				<li><code>OpenMATLAB</code> and <code>CloseMATLAB</code></li>
			</ul>
			<p>Typically, one only needs to call <code>OpenMATLAB</code>, as it automatically calls ConnectEngine. </p>
		</div>

		<div class="tab-pane fade" id="ConnectEngine">
			<blockquote><code>ConnectEngine[]</code> will connect to the MATLAB engine using MathLink.</blockquote>

			<h4>Details & Options</h4>
			<ul>
				<li>On linux and OS X, if the <code>mengine</code> binary is not found, <code>ConnectEngine</code> will try to auto compile it.</li>
				<li><code>ConnectEngine</code> creates a session directory in <code>$TemporaryDirectory</code> to which <code>MScripts</code> are written. This directory is automatically removed when <code>DisconnectEngine</code> is called.</li>
			</ul>
		</div>

		<div class="tab-pane fade" id="DisconnectEngine">
			<blockquote><code>DisconnectEngine[]</code> will terminate the MathLink connection with the MATLAB engine.</blockquote>

			<h4>Details & Options</h4>
			<ul>
				<li><code>DisconnectEngine</code> deletes the session directory in <code>$TemporaryDirectory</code> that was created by <code>ConnectEngine</code>.</li>
			</ul>
		</div>

		<div class="tab-pane fade" id="OpenMATLAB">
		</div>

		<div class="tab-pane fade" id="CloseMATLAB">
		</div>
	</div>
</section>

	<section id="evaluation">
		<h3>Evaluating MATLAB commands</h3>
		<ul id="install-tabs" class="nav nav-tabs">
			<li class="active"><a href="#evaluation-introduction" data-toggle="tab">Introduction</a></li>
			<li><a href="#MEvaluate" data-toggle="tab">MEvaluate</a></li>
			<li><a href="#CommandWindow" data-toggle="tab">CommandWindow</a></li>
		</ul>

		<div id="install-tabs-content" class="tab-content">
			<div class="tab-pane fade in active" id="evaluation-introduction">
			</div>
			<div class="tab-pane fade" id="MEvaluate">
				<blockquote><code>MEvaluate["code"]</code> will execute <code>code</code> in MATLAB as if it were entered at the command prompt and returns the output as text.</blockquote>

				<h4>Details & Options</h4>
				<ul>
					<li></li>
				</ul>

				<h4>Possible issues</h4>
				<ul>
					<li><code>MEvaluate</code> performance suffers if the output is not suppressed in MATLAB code. If you do not need to see the output of <code>MEvaluate</code>, use <code>MEvaluate["command;"]</code> instead of <code>MEvaluate["command"];</code>.
					</li>
					<li>The output length of <code>MEvaluate</code> is limited to approximatey 100,000 characters. The rest will be truncated.</li>
				</ul>
			</div>

			<div class="tab-pane fade" id="CommandWindow">
				<blockquote><code>CommandWindow["action"]</code> will perform <code>"action"</code> on MATLAB's built-in command window. This function works only on Windows.</blockquote>

				<h4>Details & Options</h4>
				<ul>
					<li><code>CommandWindow["Show"]</code> displays the command window. When an evaluation is not in progress, this window can be used to input MATLAB commands independently of MATLink.</li>
					<li><code>CommandWindow["Hide"]</code> hides the command window.</li>
				</ul>
			</div>
		</div>
	</section>
</div>

<div class="container">
	<section id="transferring-variables">
		<h3>Transferring variables</h3>
		<ul id="install-tabs" class="nav nav-tabs">
			<li class="active"><a href="#transferring-introduction" data-toggle="tab">Introduction</a></li>
			<li><a href="#MGet" data-toggle="tab">MGet</a></li>
			<li><a href="#MSet" data-toggle="tab">MSet</a></li>
		</ul>

		<div id="install-tabs-content" class="tab-content">
			<div class="tab-pane fade in active" id="connection-introduction">
			</div>

			<div class="tab-pane fade" id="MGet">
				<blockquote><code>MGet["var"]</code> will return the value of the variable <code>var</code> from the MATLAB workspace. Data structures are translated into a <i>Mathematica</i> compatible format.</blockquote>

				<h4>Details & Options</h4>
				<ul>
					<li><code>var</code> must be a string denoting the name of the variable in MATLAB
<pre class="prettyprint lang-mma">
MEvaluate["x = 1:10;"]
MGet["x"]
(* Out[1]= {1., 2., 3., 4., 5., 6., 7., 8., 9., 10.} *)
</pre></li>

					<li><code>MGet</code> is <code>Listable</code>
<pre class="prettyprint lang-mma">
MEvaluate["[v, e] = eig(rand(5));"]
{v, e} = MGet[{"v", "e"}]
</pre>
					</li>
				</ul>

				<h4>Possible issues</h4>
				<ul>
					<li>MATLAB works with floating point values by default. Even array indices are floating point, and such values need to be explicitly rounded in <i>Mathematica</i> before they can be used as indices again.
<pre class="prettyprint lang-mma">
MEvaluate["s = size(zeros(3,4));"]
s = MGet["s"]
(* Out: {3., 4.} *)
</pre>
</li>
<li>Do not attempt to use <code>MGet</code> on objects (<code>classdef</code> objects) or data structures which contain objects. This will crash MATLAB because of a MATLAB bug. See the "Known issues" section for additional details.</li>
</ul>
			</div>

			<div class="tab-pane fade" id="MSet">
				<blockquote><code>MSet["var", value]</code> will assign value to variable <code>var</code> in the MATLAB workspace.</blockquote>
				<h4>Examples</h4>
				<ul>
					<li>
<pre class="prettyprint lang-mma">
MSet["a", {1,2,3}]
MEvaluate["a"]
(* Out: a = 1  2  3 *)
</pre></li>
</ul>

				<h4>Details & Options</h4>
				<ul>
					<li><code>var</code> must be a string denoting the name of the variable in MATLAB</li>
					<li><code>value</code> must be in a MATLink compatible format.</li>

					<li>To force a list to be interpreted as a MATLAB cell, wrap it in the <code>MCell</code> head:
<pre class="prettyprint lang-mma">
MSet["a", MCell[{1, 2, 3}]]
MEvaluate["a"]
(* Out: a = [1] [2] [3] *)
</pre></li>
				</ul>

				<h4>Possible issues</h4>
				<ul>
					<li>MATLAB works with floating point values by default. Even array indices are floating point, and such values need to be explicitly rounded in <i>Mathematica</i> before they can be used as indices again.
<pre class="prettyprint lang-mma">
MEvaluate["s = size(zeros(3,4));"]
s = MGet["s"]
(* Out: {3., 4.} *)
</pre>
</li>
<li>Do not attempt to use <code>MGet</code> on objects (<code>classdef</code> objects) or data structures which contain objects. This will crash MATLAB because of a MATLAB bug. See the "Known issues" section for additional details.</li>
</ul>
			</div>

	</section>
</div>
</div>

<div class="container">
	<section id="scripts-functions">
		<h3>Scripts & Functions</h3>
		<ul id="install-tabs" class="nav nav-tabs">
			<li class="active"><a href="#scripts-introduction" data-toggle="tab">Introduction</a></li>
			<li><a href="#MScript" data-toggle="tab">MScript</a></li>
			<li><a href="#MFunction" data-toggle="tab">MFunction</a></li>
		</ul>

		<div id="install-tabs-content" class="tab-content">
			<div class="tab-pane fade in active" id="scripts-introduction">
			</div>
			<div class="tab-pane fade" id="MScript">
				<blockquote><code>MScript["scriptname", "commands"]</code> will create a MATLAB script containing <code>commands</code>.
				</blockquote>

				<h4>Details & Options</h4>
				<ul>
					<li><code>MScript["scriptname", "commands"]</code> returns <code>MScript["scriptname"]</code>, which can be evaluated using <code>MEvaluate</code>.

<pre class="prettyprint lang-mma">
hello = MScript["hello", "disp('Hello world!')"];
MEvaluate@hello
(* Out[1] = "Hello world!" *)
</pre>
					</li>
					<li>When creating new scripts, <code>MScript</code> will not overwrite exsiting <code>.m</code> files. To force overwrite an existing file, use the option <code>"Overwrite" -> True</code> (default value for <code>"Overwrite"</code> is <code>False</code>).</li>
			</div>

			<div class="tab-pane fade" id="MFunction">
				<blockquote>
					<code>MFunction["func"]</code> represents a MATLAB function <code>func</code> (that is on MATLAB's path), and can be called directly from within <i>Mathematica</i>.<br>
					<code>MFunction["func", "body"]</code> creates a new <code>.m</code> file with the contents <code>body</code> and returns <code>MFunction["func"]</code>.
				</blockquote>

				<h4>Examples</h4>
				<ul>
					<li>Calling a built-in MATLAB function
<pre class="prettyprint lang-mma">
eig = MFunction["eig"];
eig[{{1, 2}, {3, 4}}]
(* Out[1]= {{-0.372281}, {5.37228}} *)
</pre></li>
					<li>Creating a custom function and using it
<pre class="prettyprint lang-mma">
add = MFunction["add", "
	function res = add(x,y)
		res = x+y
	end "];
add[3, 4]
(* Out[1] = 7 *)
</pre>
					</li>
				</ul>

				<h4>Details & Options</h4>
				<ul>
					<li>Use <code>MFunction["func", "OutputArguments" -> n]</code> when <code>func</code> returns more than one argument (default value for <code>"OutputArguments"</code> is 1).

<pre class="prettyprint lang-mma">
eigsys = MFunction["eig", "OutputArguments" -> 2];
eigsys[{{1, 2}, {3, 4}}]
(* Out[1]= {{{-0.824565, -0.415974}, {0.565767, -0.909377}}, {{-0.372281, 0.}, {0., 5.37228}}} *)
</pre>
					</li>
					<li>If <code>func</code> returns no outputs (or to suppress output), use <code>MFunction["func", "Output" -> False]</code> (default value for <code>"Output"</code> is <code>True</code>).
<pre class="prettyprint lang-mma">
imagesc = MFunction["imagesc", "Output" -> False];
data = Import["ExampleData/ozonemap.hdf", {"Datasets", "TOTAL_OZONE"}][[20 ;;, All]];
imagesc[data];
</pre>
					</li>
					<li>When creating new functions using the syntax <code>MFunction["func", "body"]</code>, <code>MFunction</code> will not overwrite exsiting <code>.m</code> files. To force overwrite an existing file, use the option <code>"Overwrite" -> True</code> (default value for <code>"Overwrite"</code> is <code>False</code>).</li>
				</ul>

				<h4>Possible issues</h4>
				<ul>
					<li>By default <code>MFunction</code> assumes a single output argument, which causes errors in some MATLAB functions that return no output.
<pre class="prettyprint lang-mma">
MFunction["disp"]["Hello"]

MATLink::errx: Error using disp
Too many output arguments.

(* Out[1]= $Failed *)
</pre>
					Use <code>"Output" -> False</code> in such situations.</li>
				</ul>
			</div>
		</div>
	</section>
</div>

<div class="container">
	<h2>Known Issues</h2>
	<ul>
		<li>
		<h4>Large array support</h4>

		<p>At the moment, only arrays with less than <code>2^31-1</code> elements are supported.  Note that this is true for matrices and multidimensional arrays as well: the <em>total number</em> of matrix elements may not excede <code>2^31-1</code> even if the matrix has fewer rows and columns than this.  As an example, the largest supported square matrix can be of size 46341 by 46341.</p>

		<p>As a reference point, a double precision array with the maximum number of allowed elements would take up 16 GB of memory, so this limit should be more than sufficient for most applications.</p></li>

		<li><h4>Inf and NaN</h4>

		<p>Inf and Nan are not supported at the moment. The values returned to Mathematica are not safe to use: operations on them give unpredictable results.</p></li>

		<li><h4>Multiple instances of MATLAB on OS X</h4>

		<p>On OS X, if a MATLAB background process has already been started by <em>MATLink</em>, it will not be possible to launch another instance of MATLAB by clicking on its icon. As a workaround, either start MATLAB before you call <code>OpenMATLAB[]</code>or start MATLAB from the terminal as</p>

<pre>
open -n /Applications/MATLAB_R2013a.app
</pre>

<p>You can also open it by directly executing the binary from the command line:</p>

<pre>
/Applications/MATLAB_R2013a.app/bin/matlab
</pre>
</li>

<li><h4>Transferring MATLAB objects</h4>

<p>Do not use <code>MGet</code> on MATLAB objects, or data structures that contain custom classes as elements. On OS X and Unix this will crash the MATLAB process because of a bug in the MATLAB Engine interface. For example,</p>

<pre class="prettyprint lang-matlab">
m = containers.Map('a',1);
s = struct('a',1, 'b',m);
</pre>

<p>Now running <code>MGet["m"]</code> will crash MATLAB because <code>m</code> is an object. <code>MGet["s"]</code> will crash because <code>s</code> contains an object.</p>

</li>

<li><h4>Reading HDF5 based .mat files</h4>

<p>All the limitations of the <a href="http://www.mathworks.com/help/matlab/matlab_external/using-matlab-engine.html">MATLAB Engine interface</a> apply to MATLink.  The most noticeable of these is that HFD5 based <code>.mat</code> files cannot be read.  Quoting the <a href="http://www.mathworks.com/help/matlab/matlab_external/using-matlab-engine.html">MATLAB documentation</a>,</p>

<div class="quote">
The MATLAB engine cannot read MAT-files in a format based on HDF5. These are MAT-files saved using the -v7.3 option of the save function or opened using the w7.3 mode argument to the C or Fortran matOpen function.
</div>

<p>As of R2013a, MATLAB does not save <code>.mat</code> files in this format by default, unless its settings are changed.</p>
</li>

<li><h4>Unicode support</h4>

<p><code>MGet</code> and <code>MSet</code> do support Unicode strings, and will preserve Unicode characters. However, <code>MEvaluate</code> will not preserve unicode characters in its output. <code>MEvaluate</code> should handle Unicode input correctly.  If you discover a situation where it does not, please report it.</p>

<p>The reason unicode output needed to be disabled for <code>MEvaluate</code> is that MATLAB's C API is unpredictable and may not produce correct unicode output depending on version and operating system.</p>

<pre class="prettyprint lang-mma">
MEvaluate["s='Paul Erdős'"] (* Unicode input *)
(* Out: s = Paul Erd!s *)

MGet["s"]
(* Out: Paul Erdős *)
</pre>

<p>In <code>MEvaluate</code>'s output Unicode in mangled, however, <code>MGet</code> trasfers it correctly.</p>

<p>A workaround is using <code>evalc</code>.  This is not used in MATLink because of unsolved <a href="https://github.com/rsmenon/MATLink/issues/29">issue #29</a>.</p>
</li>
</ul>

<footer class="footer">
	<div class="container">
		<ul class="footer-links">
			<li>Created and maintained by <a href="https://github.com/rsmenon/">rsmenon</a> and <a href="https://github.com/szhorvat">szhorvat</a></li>
			<li class="muted">·</li>
			<li>Licensed under the <a href="http://opensource.org/licenses/mit-license.html">MIT License</a></li>
		</ul>
		<p><i>Mathematica</i> is a registered trademark of <a href="http://wolfram.com">Wolfram Research, Inc.</a> and MATLAB is a registered trademark of <a href="http://mathworks.com/">The MathWorks, Inc.</a></p>
	</div>
</footer>
</div>

<script src="/MATLink/assets/js/jquery-1.9.1.min.js"></script>
<script src="/MATLink/assets/js/underscore.min.js"></script>
<script src="/MATLink/assets/js/backbone.min.js"></script>
<script src="/MATLink/assets/js/bootstrap-222.min.js"></script>
<script src="/MATLink/assets/js/prettify.js"></script>
<script src="/MATLink/assets/js/lang-matlab.js"></script>
<script src="/MATLink/assets/js/lang-mma.js"></script>
<script type="text/javascript">
jQuery(document).ready(function () {
		// apply syntax highlighting
		prettyPrint();

		// add language selection menus (after a small delay)
		setTimeout(function () {
			add_language_selection_menu();
			}, 300);
		});
</script>

<script>
$(function () {
		$('#install-tabs a:first').tab('show');
		})
</script>
</body>
</html>
